@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="~/css/style.css" asp-append-version="true" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <main class="mainBody mainBodyRooms">
        <div class="mainBodyInner2">
            <!-- Rooms Table -->
            <div class="bookingsDashboard userDashboard">
                <div class="bookingsDashboardHeader">
                    <p class="bookingsDashboardTitle">Rooms</p>
                    <div class="users-inputGroup">
                        <button class="btn btn-sm adminAddRoomBtn" type="button" data-bs-toggle="offcanvas"
                            data-bs-target="#addUsers" aria-controls="addUsers">
                            <i class="bi bi-plus-square me-2"></i>
                            <p class="addRoomText">Add Room</p>
                        </button>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table class="table table-striped align-middle" id="adminRoomTable">
                        <thead>
                            <tr>
                                <th scope="col">Room</th>
                                <th scope="col">Style</th>
                                <th scope="col">Capacity</th>
                                <th scope="col">Status</th>
                                <th scope="col">Floor</th>
                                <th scope="col">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Rooms data will be rendered here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Booked Rooms Table -->
            <div class="bookingsDashboard userDashboard">
                <div class="bookingsDashboardHeader">
                    <p class="bookingsDashboardTitle">Booked Rooms</p>
                    <div class="users-inputGroup"></div>
                </div>
                <div class="table-wrapper">
                    <table class="table table-striped align-middle" id="adminBookedTable">
                        <thead>
                            <tr>
                                <th scope="col">Room</th>
                                <th scope="col">Style</th>
                                <th scope="col">User</th>
                                <th scope="col">No. of People</th>
                                <th scope="col">Date Booked</th>
                                <th scope="col">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Booked rooms data will be rendered here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Offcanvas for Adding Rooms -->
        <div class="offcanvas offcanvas-end" data-bs-backdrop="static" tabindex="-1" id="addUsers"
            aria-labelledby="staticBackdropLabel">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="staticBackdropLabel">Add Room</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
                <div class="offcanvas-body-inner">
                    <div class="offcanvas-body-innerMost">
                        <div>
                            <div class="mb-3">
                                <label for="exampleFormControlInput1" class="form-label">Meeting Room #</label>
                                <input type="text" class="form-control" id="exampleFormControlInput1" placeholder="">
                            </div>
                            <div class="mb-3">
                                <label for="exampleFormControlInput1" class="form-label">Meeting Room name</label>
                                <input type="text" class="form-control" id="exampleFormControlInput1" placeholder="">
                            </div>
                            <div class="mb-3">
                                <label for="userRoleAdd" class="form-label">Style</label>
                                <select class="form-select" aria-label="Default select example" id="userRoleAdd">
                                    <option selected>Classroom</option>
                                    <option value="1">Banquet</option>
                                    <option value="2">U-Shape</option>
                                    <option value="3">Conference</option>
                                    <option value="4">Auditorium</option>
                                    <option value="5">Boardroom</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="exampleFormControlInput1" class="form-label">Capacity</label>
                                <input type="number" class="form-control" id="exampleFormControlInput1" placeholder="">
                            </div>
                            <div class="mb-3">
                                <label for="exampleFormControlInput1" class="form-label">Details</label>
                                <textarea type="text-area" class="form-control" id="exampleFormControlInput1"
                                    placeholder=""></textarea>
                            </div>
                        </div>
                        <div class="buttonsOffCanvas">
                            <button type="button" class="btn btn-outline-secondary"
                                data-bs-dismiss="offcanvas">Cancel</button>
                            <button class="btn adminAddBookingBtn" type="button" data-bs-toggle="offcanvas"
                                data-bs-target="#staticBackdrop" aria-controls="staticBackdrop">
                                <i class="bi bi-plus-square me-2"></i>Add Room
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        // // Dummy Data for Rooms
        // const roomsData = [
        //     { room: 2, style: 'Classroom', capacity: 30, status: 'Available', floor: 2 },
        //     { room: 4, style: 'Banquet', capacity: 40, status: 'Booked', floor: 4 },
        //     { room: 6, style: 'Auditorium', capacity: 50, status: 'Available', floor: 8 },
        //     { room: 11, style: 'Boardroom', capacity: 15, status: 'Available', floor: 1 },
        //     { room: 1, style: 'Boardroom', capacity: 15, status: 'Booked', floor: 1 },
        //     { room: 9, style: 'U-Shape', capacity: 18, status: 'Booked', floor: 3 }
        // ];

        // // Dummy Data for Booked Rooms
        // const bookedRoomsData = [
        //     { room: 2, style: 'Classroom', user: 'Dean Lourence Barquio', no_of_people: 7, date_booked: '01/23/2024' },
        //     { room: 4, style: 'Banquet', user: 'Dean Lourence Barquio', no_of_people: 25, date_booked: '02/06/2024' },
        //     { room: 6, style: 'Auditorium', user: 'Dean Lourence Barquio', no_of_people: 12, date_booked: '05/18/2024' },
        //     { room: 11, style: 'Boardroom', user: 'Dean Lourence Barquio', no_of_people: 10, date_booked: '06/01/2024' },
        //     { room: 8, style: 'Boardroom', user: 'Dean Lourence Barquio', no_of_people: 15, date_booked: '07/10/2024' },
        //     { room: 9, style: 'U-Shape', user: 'Dean Lourence Barquio', no_of_people: 20, date_booked: '08/15/2024' }
        // ];

        document.addEventListener('DOMContentLoaded', fetchRooms);

        async function fetchRooms() {
            try {
                const response = await fetch('/api/Room/GetRooms');
                if (response.ok) {
                    const rooms = await response.json();
                    renderRooms(rooms);
                } else {
                    console.error('Failed to fetch room data');
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        function renderRooms(rooms) {
            const tbody = document.querySelector('#adminRoomTable tbody');
            tbody.innerHTML = ''; // Clear previous rows

            rooms.forEach(room => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${room.name}</td>
                    <td>${room.style}</td>
                    <td>${room.capacity}</td>
                    <td style="color: ${room.status === 'Available' ? 'green' : 'red'}">${room.status}</td>
                    <td>${room.floor}</td>
                    <td class="actionBtnUsers">
                        <i class="bi bi-pencil-square editIconBtn" onclick="editRoom(${room.roomId})"></i>
                        <i class="bi bi-trash3 ms-2 deleteIconBtn" onclick="deleteRoom(${room.roomId})"></i>
                    </td>`;
                tbody.appendChild(row);
            });
        }

    </script>
</body>

</html>
